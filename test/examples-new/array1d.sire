val N := NUM_CORES-1;
  
proc node(chanend left, chanend right) is
  var v;
{ left ? v ; right ! v + 1 }

proc main() is
  var i;
  var v;
  chan c[N+1];
{ { c[0] ! 0 
  ; c[N] ? v 
  ; printvalln(v)
  }
|| par i in [0 for N] do node(c[i], c[i+1])
}
