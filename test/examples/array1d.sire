val N:=2;

proc foo(val i, chanend a, chanend b) is
  var v;
{ if i = 0 
  then
  { b ! 1; 
    a ? v;
    assert v = 2
  }
  else
  { a ? v; 
    b ! v+1;
  }
}

proc main() is
  chan c[N];
  var i;
  par i in [0 for N] do
    foo(i, c[i], c[(i+1) rem N])

